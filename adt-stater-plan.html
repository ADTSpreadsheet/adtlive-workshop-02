<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üöÄ Starter Plan Register - ADTSpreadsheet</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 50%, #93c5fd 100%);
      min-height: 100vh;
    }
    
    .form-input {
      transition: all 0.3s ease;
      border: 2px solid #e5e7eb;
    }
    
    .form-input:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      outline: none;
    }
    
    .emoji-label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #374151;
    }
    
    .gradient-button {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      transition: all 0.3s ease;
    }
    
    .gradient-button:hover {
      background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
      transform: translateY(-1px);
      box-shadow: 0 10px 20px rgba(59, 130, 246, 0.4);
    }
    
    .card-hover {
      transition: all 0.3s ease;
    }
    
    .card-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    .success-message, .error-message {
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="min-h-screen">

  <!-- ‚ú® HEADER -->
  <div class="bg-white text-center py-8 px-6 shadow-xl border border-gray-200 rounded-2xl mx-auto mb-8 max-w-4xl mt-6 card-hover">
    <h1 class="text-4xl font-bold text-gray-900 mb-4">
      üèóÔ∏è ADTSpreadsheet
    </h1>
    <p class="text-gray-600 leading-relaxed mb-4">
      üí° ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢ ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡πÇ‡∏î‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÅ‡∏£‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (WSD)<br>
      üìö ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢ (E.I.T. Standard 1007-34)
    </p>
    <div class="inline-flex items-center px-4 py-2 bg-blue-100 text-blue-800 rounded-full">
      <span class="mr-2">üéØ</span>
      <span class="font-semibold">Starter Plan</span>
    </div>
  </div>

  <!-- üöÄ FORM -->
  <div class="max-w-2xl mx-auto my-8 p-8 bg-white shadow-xl rounded-2xl card-hover">
    <h2 class="text-3xl font-bold text-center mb-2 text-gray-900">
      üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    </h2>
    <p class="text-center text-gray-600 mb-8">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</p>
    
    <form id="starterForm" class="space-y-6">
      
      <div>
        <label class="emoji-label">
          <span>üîë</span>
          <span>Ref. Code</span>
        </label>
        <input type="text" id="ref_code" class="form-input w-full px-4 py-3 rounded-xl" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Ref. Code" required>
      </div>

      <div>
        <label class="emoji-label">
          <span>üë§</span>
          <span>‡∏ä‡∏∑‡πà‡∏≠</span>
        </label>
        <input type="text" id="first_name" class="form-input w-full px-4 py-3 rounded-xl" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" required>
      </div>

      <div>
        <label class="emoji-label">
          <span>üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
          <span>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</span>
        </label>
        <input type="text" id="last_name" class="form-input w-full px-4 py-3 rounded-xl" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" required>
      </div>

      <div>
        <label class="emoji-label">
          <span>üÜî</span>
          <span>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô 13 ‡∏´‡∏•‡∏±‡∏Å</span>
        </label>
        <input type="text" id="national_id" maxlength="13" pattern="[0-9]{13}" class="form-input w-full px-4 py-3 rounded-xl" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô 13 ‡∏´‡∏•‡∏±‡∏Å" required>
      </div>

      <div>
        <label class="emoji-label">
          <span>üì±</span>
          <span>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</span>
        </label>
        <input type="tel" id="phone_number" maxlength="10" pattern="0[0-9]{8,9}" class="form-input w-full px-4 py-3 rounded-xl" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå" required>
      </div>

      <div>
        <label class="emoji-label">
          <span>üìÖ</span>
          <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô</span>
        </label>
        <select id="duration" class="form-input w-full px-4 py-3 rounded-xl" required>
          <option value="">üéØ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô</option>
        </select>
      </div>

      <div id="paymentSection" class="mt-8 hidden">
        <div class="text-center mb-6">
          <h3 class="text-xl font-semibold text-gray-900 mb-2">
            üí≥ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
          </h3>
          <p class="text-gray-600">‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
        </div>
        
        <div class="flex justify-center mb-6">
          <div class="bg-white p-4 rounded-xl shadow-lg">
            <img id="qrImage" src="" alt="QR Code" class="w-64 rounded-lg">
          </div>
        </div>
        
        <div>
          <label class="emoji-label">
            <span>üßæ</span>
            <span>‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</span>
          </label>
          <input type="file" id="slipFile" accept="image/*" class="form-input w-full px-4 py-3 rounded-xl" required>
          <small class="text-gray-500 mt-2 block">
            üìé ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå JPG, PNG ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB
          </small>
        </div>

        <button type="submit" id="submitBtn" class="gradient-button w-full text-white font-bold py-4 px-6 rounded-xl mt-6 flex items-center justify-center gap-2">
          <span>‚úÖ</span>
          <span>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</span>
        </button>
      </div>
    </form>

    <div id="messageContainer" class="mt-6">
      <div id="successMessage" class="bg-green-50 border-2 border-green-200 text-green-800 px-6 py-4 rounded-xl hidden success-message">
        <div class="flex items-center">
          <span class="text-xl mr-3">üéâ</span>
          <div>
            <strong>‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</strong>
            <span id="successText"></span>
          </div>
        </div>
      </div>
      <div id="errorMessage" class="bg-red-50 border-2 border-red-200 text-red-800 px-6 py-4 rounded-xl hidden error-message">
        <div class="flex items-center">
          <span class="text-xl mr-3">‚ùå</span>
          <div>
            <strong>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!</strong>
            <span id="errorText"></span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- üåü FOOTER -->
  <div class="max-w-2xl mx-auto mb-8 p-6 bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg">
    <div class="text-center text-gray-700 space-y-2">
      <p class="flex items-center justify-center gap-2">
        <span>üîí</span>
        <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á</span>
      </p>
      <p class="flex items-center justify-center gap-2">
        <span>üìû</span>
        <span>‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô ADT</span>
      </p>
      <p class="flex items-center justify-center gap-2">
        <span>‚ö°</span>
        <span>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</span>
      </p>
    </div>
  </div>

  <script>
    const qrImage = document.getElementById("qrImage");
    const durationSelect = document.getElementById("duration");
    const paymentSection = document.getElementById("paymentSection");
    const successMessage = document.getElementById("successMessage");
    const errorMessage = document.getElementById("errorMessage");
    const successText = document.getElementById("successText");
    const errorText = document.getElementById("errorText");
    const messageContainer = document.getElementById("messageContainer");

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥
    for (let i = 1; i <= 15; i++) {
      const opt = document.createElement("option");
      opt.value = i;
      opt.textContent = `${i} ‡∏ß‡∏±‡∏ô ‚è∞`;
      durationSelect.appendChild(opt);
    }

    durationSelect.addEventListener("change", function () {
      const val = parseInt(this.value);
      if (!isNaN(val)) {
        const fileNumber = 142657 + val;
        qrImage.src = `https://wpxpukbvynxawfxcdroj.supabase.co/storage/v1/object/public/staterplanpayslip/${fileNumber}.jpg`;
        paymentSection.classList.remove("hidden");
        // Smooth scroll to payment section
        paymentSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      } else {
        paymentSection.classList.add("hidden");
      }
    });

    function showSuccess(msg) {
      successText.textContent = msg;
      successMessage.classList.remove("hidden");
      errorMessage.classList.add("hidden");
      
      // Auto hide after 5 seconds
      setTimeout(() => {
        successMessage.classList.add("hidden");
      }, 5000);
    }

    function showError(msg) {
      errorText.textContent = msg;
      errorMessage.classList.remove("hidden");
      successMessage.classList.add("hidden");
      
      // Auto hide after 8 seconds
      setTimeout(() => {
        errorMessage.classList.add("hidden");
      }, 8000);
    }

    function hideMessages() {
      successMessage.classList.add("hidden");
      errorMessage.classList.add("hidden");
    }

    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        if (file.size > 10 * 1024 * 1024) return reject("‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡∏¥‡∏ô 10MB");
        if (!file.type.startsWith("image/")) return reject("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = () => reject("‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        reader.readAsDataURL(file);
      });
    }

    document.getElementById("starterForm").addEventListener("submit", async function (e) {
      e.preventDefault();
      hideMessages();

      const slipFile = document.getElementById("slipFile").files[0];
      if (!slipFile) return showError("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô");

      const submitBtn = document.getElementById("submitBtn");
      const originalHTML = submitBtn.innerHTML;
      submitBtn.innerHTML = '<span>‚è≥</span><span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</span>';
      submitBtn.disabled = true;

      try {
        const base64 = await fileToBase64(slipFile);
        const payload = {
          ref_code: document.getElementById("ref_code").value,
          first_name: document.getElementById("first_name").value,
          last_name: document.getElementById("last_name").value,
          national_id: document.getElementById("national_id").value,
          phone_number: document.getElementById("phone_number").value,
          duration: parseInt(document.getElementById("duration").value),
          file_content: base64
        };

        const res = await fetch("https://line-bot-adt.onrender.com/starter/submit-starter-slip", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        let result = {};
        try {
          result = await res.json();
        } catch (err) {
          console.warn("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á JSON ‡πÑ‡∏î‡πâ:", err);
        }

        if (res.status === 200) {
          showSuccess("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ô‡∏≥‡πÑ‡∏õ‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ...");
          
          // ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ Thank You ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
          setTimeout(() => {
            window.location.href = "https://adtlive-workshop-02.onrender.com/staterplan-thankyou.html";
          }, 1500);
          
        } else {
          showError(result?.message || "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö");
        }

      } catch (err) {
        console.error("‚ùå ERROR:", err);
        showError(err.message || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ");
      } finally {
        submitBtn.innerHTML = originalHTML;
        submitBtn.disabled = false;
      }
    });

    // Auto-format ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô
    document.getElementById('national_id').addEventListener('input', function(e) {
      this.value = this.value.replace(/\D/g, '');
    });

    // Auto-format ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå
    document.getElementById('phone_number').addEventListener('input', function(e) {
      this.value = this.value.replace(/\D/g, '');
    });
  </script>
</body>
</html>
